{"version":3,"file":"static/js/87.41efe6fc.chunk.js","mappings":"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","sources":["AuthProvider.jsx"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL;\r\nconst API = `${BACKEND_URL}/api`;\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nconst AuthContext = createContext();\r\n\r\nconst AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [token, setToken] = useState(localStorage.getItem('token'));\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (token) {\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n      fetchUser();\r\n    } else {\r\n      setUser(null);\r\n      delete axios.defaults.headers.common['Authorization'];\r\n    }\r\n  }, [token]);\r\n\r\n  const fetchUser = async () => {\r\n    try {\r\n      const response = await axios.get(`${API}/auth/me/`);\r\n      setUser(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error fetching user:\", error);\r\n      logout();\r\n    }\r\n  };\r\n\r\n  const login = async (email, password) => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.post(`${API}/auth/login/`, { email, password });\r\n      const { access_token, user: userData } = response.data;\r\n      localStorage.setItem('token', access_token);\r\n      setToken(access_token);\r\n      setUser(userData);\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`;\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error(\"Login error:\", error.response?.data || error.message);\r\n      return { success: false, error: error.response?.data?.detail || 'Login failed' };\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const register = async (email, password, name, role = 'customer') => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await axios.post(`${API}/auth/register/`, { \r\n        email, password, name, role\r\n      });\r\n      const { access_token, user: userData } = response.data;\r\n      localStorage.setItem('token', access_token);\r\n      setToken(access_token);\r\n      setUser(userData);\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`;\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error(\"Registration error:\", error.response?.data || error.message);\r\n      return { success: false, error: error.response?.data?.detail || 'Registration failed' };\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem('token');\r\n    setToken(null);\r\n    setUser(null);\r\n    delete axios.defaults.headers.common['Authorization'];\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, login, register, logout, loading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\nconst useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport { AuthProvider, useAuth };\r\nexport default AuthProvider;"],"names":["API","axios","defaults","withCredentials","AuthContext","createContext","AuthProvider","_ref","children","user","setUser","useState","token","setToken","localStorage","getItem","loading","setLoading","useEffect","headers","common","fetchUser","async","response","get","data","error","console","logout","removeItem","_jsx","Provider","value","login","email","password","post","access_token","userData","setItem","success","_error$response","_error$response2","_error$response2$data","message","detail","register","name","role","arguments","length","undefined","_error$response3","_error$response4","_error$response4$data","useAuth","context","useContext","Error"],"sourceRoot":""}