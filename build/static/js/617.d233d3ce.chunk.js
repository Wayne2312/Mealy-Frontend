"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[87,617],{87:(e,s,t)=>{t.r(s),t.d(s,{AuthProvider:()=>o,default:()=>c,useAuth:()=>i});var a=t(43),r=t(213),l=t(579);const n="http://localhost:8000/api";r.A.defaults.withCredentials=!0;const d=(0,a.createContext)(),o=e=>{let{children:s}=e;const[t,o]=(0,a.useState)(null),[i,c]=(0,a.useState)(localStorage.getItem("token")),[m,x]=(0,a.useState)(!1);(0,a.useEffect)(()=>{i?(r.A.defaults.headers.common.Authorization=`Bearer ${i}`,u()):(o(null),delete r.A.defaults.headers.common.Authorization)},[i]);const u=async()=>{try{const e=await r.A.get(`${n}/auth/me/`);o(e.data)}catch(e){console.error("Error fetching user:",e),h()}},h=()=>{localStorage.removeItem("token"),c(null),o(null),delete r.A.defaults.headers.common.Authorization};return(0,l.jsx)(d.Provider,{value:{user:t,login:async(e,s)=>{x(!0);try{const t=await r.A.post(`${n}/auth/login/`,{email:e,password:s}),{access_token:a,user:l}=t.data;return localStorage.setItem("token",a),c(a),o(l),r.A.defaults.headers.common.Authorization=`Bearer ${a}`,{success:!0}}catch(d){var t,a,l;return console.error("Login error:",(null===(t=d.response)||void 0===t?void 0:t.data)||d.message),{success:!1,error:(null===(a=d.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.detail)||"Login failed"}}finally{x(!1)}},register:async function(e,s,t){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"customer";x(!0);try{const l=await r.A.post(`${n}/auth/register/`,{email:e,password:s,name:t,role:a}),{access_token:d,user:i}=l.data;return localStorage.setItem("token",d),c(d),o(i),r.A.defaults.headers.common.Authorization=`Bearer ${d}`,{success:!0}}catch(m){var l,d,i;return console.error("Registration error:",(null===(l=m.response)||void 0===l?void 0:l.data)||m.message),{success:!1,error:(null===(d=m.response)||void 0===d||null===(i=d.data)||void 0===i?void 0:i.detail)||"Registration failed"}}finally{x(!1)}},logout:h,loading:m},children:s})},i=()=>{const e=(0,a.useContext)(d);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},c=o},617:(e,s,t)=>{t.r(s),t.d(s,{default:()=>p});var a=t(43),r=t(87),l=t(579);const n=()=>{const{user:e,logout:s}=(0,r.useAuth)();return(0,l.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 bg-orange-500 rounded-lg flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold text-lg",children:"\ud83c\udf7d\ufe0f"})}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Mealy"})]}),e&&(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("span",{className:"text-sm text-gray-600",children:["Hello, ",e.name]}),(0,l.jsx)("button",{onClick:s,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors",children:"Logout"})]})]})})})},d=()=>{const{login:e,register:s,loading:t}=(0,r.useAuth)(),[n,d]=(0,a.useState)(!0),[o,i]=(0,a.useState)({email:"",password:"",name:"",role:"customer"}),[c,m]=(0,a.useState)("");return(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,l.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,l.jsx)("div",{className:"mx-auto w-20 h-20 bg-orange-500 rounded-full flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white text-3xl",children:"\ud83c\udf7d\ufe0f"})}),(0,l.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Welcome to Mealy"}),(0,l.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Your favorite food ordering platform"})]}),(0,l.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,l.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,l.jsxs)("form",{className:"space-y-6",onSubmit:async t=>{let a;t.preventDefault(),m(""),a=n?await e(o.email,o.password):await s(o.email,o.password,o.name,o.role),a.success||m(a.error)},children:[c&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:c}),!n&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,l.jsx)("input",{id:"name",type:"text",required:!0,className:"mt-1 appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-orange-500 focus:border-orange-500 focus:z-10 sm:text-sm",placeholder:"Enter your name",value:o.name,onChange:e=>i({...o,name:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,l.jsx)("input",{id:"email",type:"email",required:!0,className:"mt-1 appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-orange-500 focus:border-orange-500 focus:z-10 sm:text-sm",placeholder:"Enter your email",value:o.email,onChange:e=>i({...o,email:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,l.jsx)("input",{id:"password",type:"password",required:!0,className:"mt-1 appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-orange-500 focus:border-orange-500 focus:z-10 sm:text-sm",placeholder:"Enter your password",value:o.password,onChange:e=>i({...o,password:e.target.value})})]}),!n&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700",children:"Account Type"}),(0,l.jsxs)("select",{id:"role",className:"mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm",value:o.role,onChange:e=>i({...o,role:e.target.value}),children:[(0,l.jsx)("option",{value:"customer",children:"Customer"}),(0,l.jsx)("option",{value:"admin",children:"Admin/Caterer"})]})]}),(0,l.jsx)("button",{type:"submit",disabled:t,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50",children:t?"Processing...":n?"Sign In":"Sign Up"}),(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("button",{type:"button",className:"font-medium text-orange-600 hover:text-orange-500",onClick:()=>d(!n),children:n?"Need an account? Sign up":"Already have an account? Sign in"})})]})})})]})};var o=t(213),i=t(721),c=t(973);const m="http://localhost:8000/api",x=()=>{const{user:e}=(0,r.useAuth)(),[s,t]=(0,a.useState)([]),[n,d]=(0,a.useState)([]),[x,u]=(0,a.useState)("menu"),[h,g]=(0,a.useState)(!1),[p,y]=(0,a.useState)(!1),[f,b]=(0,a.useState)(null),[j,v]=(0,a.useState)("pending"),[N,w]=(0,a.useState)(null),k=((0,i.Zp)(),async()=>{try{const e=await o.A.get(`${m}/orders/`);d(e.data)}catch(e){console.error("Error fetching orders:",e)}});(0,a.useEffect)(()=>{(async()=>{try{const e=await o.A.get(`${m}/daily-menu/today/menu/`);t(e.data.meals||[])}catch(e){console.error("Error fetching menu:",e)}})(),k()},[]);const{status:C,error:A}=(0,c.A)(f,j);(0,a.useEffect)(()=>{C&&C!==j&&v(C),A&&A!==N&&w(A),"completed"!==C&&"failed"!==C||(y(!1),k())},[C,A,j,N,k]);return(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("h2",{className:"text-3xl font-bold text-gray-900",children:["Welcome back, ",e.name,"!"]}),(0,l.jsx)("p",{className:"text-gray-600",children:"What would you like to eat today?"})]}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsxs)("nav",{className:"flex space-x-8",children:[(0,l.jsx)("button",{onClick:()=>u("menu"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("menu"===x?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Today's Menu"}),(0,l.jsxs)("button",{onClick:()=>u("orders"),className:"py-2 px-1 border-b-2 font-medium text-sm "+("orders"===x?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["My Orders (",n.length,")"]})]})}),"menu"===x&&(0,l.jsx)("div",{children:0===s.length?(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,l.jsx)("span",{className:"text-gray-400 text-2xl",children:"\ud83c\udf7d\ufe0f"})}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No menu available today"}),(0,l.jsx)("p",{className:"text-gray-500",children:"Check back later or contact your caterer."})]}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,l.jsx)("div",{className:"h-48 bg-gray-200 flex items-center justify-center",children:e.image_url?(0,l.jsx)("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,l.jsx)("span",{className:"text-6xl",children:"\ud83c\udf7d\ufe0f"})}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:e.name}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("span",{className:"text-2xl font-bold text-orange-600",children:["KSh ",e.price]}),(0,l.jsx)("button",{onClick:()=>(async e=>{g(!0);try{await o.A.post(`${m}/orders/`,{meal_id:e,quantity:1}),await k(),alert("Order placed successfully!")}catch(a){var s,t;alert("Error placing order: "+((null===(s=a.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail)||"Unknown error"))}finally{g(!1)}})(e.id),disabled:h,className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-medium disabled:opacity-50",children:h?"Ordering...":"Order Now"})]})]})]},e.id))})}),"orders"===x&&(0,l.jsx)("div",{children:0===n.length?(0,l.jsxs)("div",{className:"text-center py-12",children:[(0,l.jsx)("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:(0,l.jsx)("span",{className:"text-gray-400 text-2xl",children:"\ud83d\udce6"})}),(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders yet"}),(0,l.jsx)("p",{className:"text-gray-500",children:"Place your first order from today's menu!"})]}):(0,l.jsx)("div",{className:"space-y-4",children:n.map(e=>(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.meal_name}),(0,l.jsxs)("p",{children:["Total: KSh ",e.total_amount]}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["Ordered on: ",new Date(e.order_date).toLocaleString()]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-orange-600 mb-2",children:["KSh ",e.total]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium "+("confirmed"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"cancelled"===e.status?"bg-red-100 text-red-800":"completed"===e.status?"bg-blue-100 text-blue-800":"preparing"===e.status||"ready"===e.status?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),"pending"===e.status||"confirmed"===e.status?(0,l.jsxs)(l.Fragment,{children:["pending"===e.payment_status&&(0,l.jsx)("button",{onClick:()=>(async e=>{const s=prompt("Enter your M-Pesa phone number (e.g., 0712345678):");if(!s)return;const t=(e=>{const s=e.replace(/\D/g,"");return s.startsWith("0")?"254"+s.substring(1):s.startsWith("7")&&9===s.length?"254"+s:s})(s);if(t.startsWith("254")&&12===t.length){y(!0),b(e),v("pending"),w(null),y(!0);try{const s=await o.A.post(`${m}/mpesa-payment/`,{order_id:e,phone:t},{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});s.data.success?console.log(`Payment request sent to ${t}. Please complete the transaction on your phone.`):(v("failed"),w(s.data.error||"Payment initiation failed"),y(!1),alert(s.data.error||"Payment initiation failed"))}catch(l){var a,r;alert("Payment failed: "+((null===(a=l.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.error)||"Unknown error"))}finally{y(!1)}}else alert("Please enter a valid Kenyan phone number (e.g., 0712345678)")})(e.id),disabled:p,className:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-md text-sm font-medium disabled:opacity-50",children:p?"Processing...":"Pay with M-Pesa"}),"completed"!==e.payment_status&&(0,l.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to cancel this order?")){g(!0);try{const s=await o.A.post(`${m}/orders/cancel/`,{order_id:e});s.data.message&&(alert(s.data.message),await k())}catch(l){var s,t,a,r;null!==(s=l.response)&&void 0!==s&&null!==(t=s.data)&&void 0!==t&&t.error?alert("Cancellation failed: "+l.response.data.error):alert("Cancellation failed: "+((null===(a=l.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.detail)||"Unknown error"))}finally{g(!1)}}})(e.id),disabled:h,className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-md text-sm font-medium disabled:opacity-50",children:"Cancel Order"})]}):"cancelled"===e.status?(0,l.jsx)("span",{className:"text-sm text-gray-500 italic",children:"Order Cancelled"}):"completed"===e.status?(0,l.jsx)("span",{className:"text-sm text-gray-500 italic",children:"Order Completed"}):null]})]})]})},e.id))})})]})},u="http://localhost:8000/api",h=()=>{const{user:e}=(0,r.useAuth)(),[s,t]=(0,a.useState)("meals"),[n,d]=(0,a.useState)([]),[i,c]=(0,a.useState)([]),[m,x]=(0,a.useState)({total_revenue:0,total_orders:0}),[h,g]=(0,a.useState)(!1),[p,y]=(0,a.useState)({name:"",description:"",price:"",category:"",image_url:""}),[f,b]=(0,a.useState)([]),[j,v]=(0,a.useState)((new Date).toISOString().split("T")[0]);(0,a.useEffect)(()=>{N(),w(),k()},[]);const N=async()=>{try{const e=await o.A.get(`${u}/meals/`);d(e.data)}catch(e){console.error("Error fetching meals:",e)}},w=async()=>{try{const e=await o.A.get(`${u}/orders/`);c(e.data)}catch(e){console.error("Error fetching orders:",e)}},k=async()=>{try{const e=await o.A.get(`${u}/orders/today/revenue/`);x(e.data)}catch(e){console.error("Error fetching revenue:",e)}},C=e=>{const s={Appetizer:"Add image URL here","Main Course":"Add image URL here",Burger:"Add image URL here",Dessert:"Add image URL here",default:"Add image URL here"};return s[e]||s.default};return(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage your restaurant operations"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-green-600 text-xl",children:"\ud83d\udcb0"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Today's Revenue"}),(0,l.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["KSh ",m.total_revenue]})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-blue-600 text-xl",children:"\ud83d\udce6"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Today's Orders"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:m.total_orders})]})]})}),(0,l.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-purple-600 text-xl",children:"\ud83c\udf7d\ufe0f"})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Meals"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]})]})})]}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)("nav",{className:"flex space-x-8",children:[{id:"meals",label:"Meals",count:n.length},{id:"menu",label:"Daily Menu"},{id:"orders",label:"Orders",count:i.length}].map(e=>(0,l.jsxs)("button",{onClick:()=>t(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.label," ",e.count&&`(${e.count})`]},e.id))})}),"meals"===s&&(0,l.jsxs)("div",{className:"space-y-8",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add New Meal"}),(0,l.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),g(!0);try{await o.A.post(`${u}/meals/`,{...p,price:parseFloat(p.price)}),y({name:"",description:"",price:"",category:"",image_url:""}),await N(),alert("Meal created successfully!")}catch(a){var s,t;alert("Error creating meal: "+((null===(s=a.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail)||"Unknown error"))}finally{g(!1)}},className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"mealName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Meal Name"}),(0,l.jsx)("input",{id:"mealName",type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500",value:p.name,onChange:e=>y({...p,name:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"mealCategory",className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,l.jsxs)("select",{id:"mealCategory",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500",value:p.category,onChange:e=>y({...p,category:e.target.value,image_url:C(e.target.value)}),children:[(0,l.jsx)("option",{value:"",children:"Select Category"}),(0,l.jsx)("option",{value:"Main Course",children:"Main Course"}),(0,l.jsx)("option",{value:"Burger",children:"Burger"}),(0,l.jsx)("option",{value:"Dessert",children:"Dessert"}),(0,l.jsx)("option",{value:"Beverage",children:"Beverage"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"mealPrice",className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (KSh)"}),(0,l.jsx)("input",{id:"mealPrice",type:"number",step:"0.01",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500",value:p.price,onChange:e=>y({...p,price:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"mealImage",className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL (Optional)"}),(0,l.jsx)("input",{id:"mealImage",type:"url",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500",value:p.image_url,onChange:e=>y({...p,image_url:e.target.value})})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"mealDescription",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,l.jsx)("textarea",{id:"mealDescription",required:!0,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500",value:p.description,onChange:e=>y({...p,description:e.target.value})})]}),(0,l.jsx)("div",{className:"md:col-span-2",children:(0,l.jsx)("button",{type:"submit",disabled:h,className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-medium disabled:opacity-50",children:h?"Creating...":"Create Meal"})})]})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,l.jsx)("div",{className:"h-48 bg-gray-200 flex items-center justify-center",children:e.image_url?(0,l.jsx)("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,l.jsx)("span",{className:"text-6xl",children:"\ud83c\udf7d\ufe0f"})}),(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,l.jsx)("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded",children:e.category})]}),(0,l.jsx)("p",{className:"text-gray-600 text-sm mb-3",children:e.description}),(0,l.jsxs)("div",{className:"text-xl font-bold text-orange-600",children:["KSh ",e.price]}),(0,l.jsx)("button",{onClick:()=>(async e=>{const s=n.find(s=>s.id===e);if(window.confirm(`Are you sure you want to delete "${null===s||void 0===s?void 0:s.name}"? This action cannot be undone.`)){g(!0);try{await o.A.delete(`${u}/meals/${e}/`),await N(),alert("Meal deleted successfully!")}catch(r){var t,a;const e=(null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.error)||"Unknown error";alert("Error deleting meal: "+e)}finally{g(!1)}}})(e.id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm",children:"Delete"})]})]},e.id))})]}),"menu"===s&&(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Create Daily Menu"}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("label",{htmlFor:"menuDate",className:"block text-sm font-medium text-gray-700 mb-2",children:"Menu Date"}),(0,l.jsx)("input",{id:"menuDate",type:"date",className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500",value:j,onChange:e=>v(e.target.value)})]}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:["Select Meals for Menu (",f.length," selected)"]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(e=>(0,l.jsx)("div",{className:"border-2 rounded-lg p-4 cursor-pointer transition-colors "+(f.includes(e.id)?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-orange-300"),onClick:()=>{return s=e.id,void b(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s},children:(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center overflow-hidden",children:e.image_url?(0,l.jsx)("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover"}):(0,l.jsx)("span",{className:"text-lg",children:"\ud83c\udf7d\ufe0f"})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h5",{className:"font-medium text-gray-900",children:e.name}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["KSh ",e.price]})]}),(0,l.jsx)("div",{className:"w-5 h-5 rounded border-2 "+(f.includes(e.id)?"bg-orange-500 border-orange-500":"border-gray-300"),children:f.includes(e.id)&&(0,l.jsx)("span",{className:"text-white text-xs",children:"\u2713"})})]})},e.id))})]}),(0,l.jsx)("button",{onClick:async()=>{if(0!==f.length){g(!0);try{await o.A.post(`${u}/daily-menu/`,{date:j,meal_ids:f}),b([]),alert("Daily menu created successfully!")}catch(t){var e,s;alert("Error creating menu: "+((null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Unknown error"))}finally{g(!1)}}else alert("Please select at least one meal for the menu")},disabled:h||0===f.length,className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-medium disabled:opacity-50",children:h?"Creating...":"Create Daily Menu"})]}),"orders"===s&&(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,l.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"All Orders"})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Details"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(e=>(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.meal_name}),(0,l.jsxs)("div",{className:"text-sm text-gray-500",children:["Qty: ",e.quantity]})]}),(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["Customer ID: ",String(e.customer_id).slice(0,8),"..."]}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.date}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+("completed"===e.payment_status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:"completed"===e.payment_status?"Paid":"Pending Payment"})}),(0,l.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["KSh ",e.total]})]},e.id))})]})})]})]})};const g=function(){const[e,s]=(0,a.useState)(!1),t=()=>{s(!0)};return e?(0,l.jsx)(d,{}):(0,l.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,l.jsx)("header",{className:"sticky top-0 z-50 bg-white shadow-md",children:(0,l.jsxs)("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-8 h-8 bg-orange-500 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,l.jsx)("span",{className:"text-white font-bold text-lg",children:"\ud83c\udf7d\ufe0f"})}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900 whitespace-nowrap",children:"Mealy"})]}),(0,l.jsxs)("div",{className:"flex space-x-3",children:[(0,l.jsx)("button",{onClick:t,className:"px-4 py-2 border-2 border-orange-500 text-orange-500 rounded-full font-medium hover:bg-orange-500 hover:text-white transition-colors",children:"Login"}),(0,l.jsx)("button",{onClick:t,className:"px-4 py-2 bg-orange-500 text-white rounded-full font-medium hover:bg-orange-600 transition-colors",children:"Sign Up"})]})]})}),(0,l.jsx)("section",{className:"py-12 md:py-20 bg-gray-50",children:(0,l.jsxs)("div",{className:"container mx-auto px-4 flex flex-col md:flex-row items-center",children:[(0,l.jsxs)("div",{className:"md:w-1/2 mb-10 md:mb-0 md:pr-10",children:[(0,l.jsx)("h1",{className:"text-4xl md:text-5xl font-bold text-gray-800 leading-tight mb-4",children:"Delicious Food, Delivered to You"}),(0,l.jsx)("p",{className:"text-lg text-gray-600 mb-8",children:"Connect restaurants with hungry customers. Admins manage menus, customers order with ease."}),(0,l.jsx)("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4"})]}),(0,l.jsx)("div",{className:"md:w-1/2 rounded-xl overflow-hidden shadow-xl",children:(0,l.jsx)("img",{src:"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",alt:"Food delivery",className:"w-full h-auto object-cover"})})]})}),(0,l.jsx)("section",{id:"features",className:"py-16 bg-gray-50",children:(0,l.jsxs)("div",{className:"container mx-auto px-4",children:[(0,l.jsx)("h2",{className:"text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12",children:"Why Choose Mealy?"}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{icon:"\ud83d\udccb",title:"Easy Menu Management",desc:"Admins can easily create, update, and manage food menus in real-time."},{icon:"\ud83c\udf54",title:"Wide Food Selection",desc:"Browse menus from multiple restaurants and cuisines in one place."},{icon:"\u23f1\ufe0f",title:"Fast Delivery",desc:"Get your favorite meals delivered quickly to your doorstep."}].map((e,s)=>(0,l.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-md hover:shadow-lg transition-shadow",children:[(0,l.jsx)("div",{className:"text-4xl mb-4",children:e.icon}),(0,l.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:e.title}),(0,l.jsx)("p",{className:"text-gray-600",children:e.desc})]},s))})]})}),(0,l.jsx)("section",{className:"py-16 bg-gray-50",children:(0,l.jsxs)("div",{className:"container mx-auto px-4",children:[(0,l.jsx)("h2",{className:"text-3xl md:text-4xl font-bold text-center text-gray-800 mb-12",children:"Designed for Both Roles"}),(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,l.jsx)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden flex-1 border-t-4 border-orange-500",children:(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"For Restaurant Admins"}),(0,l.jsx)("ul",{className:"mb-8 space-y-3",children:["Easy menu creation and management","Real-time order notifications","Sales analytics dashboard","Customer feedback management"].map((e,s)=>(0,l.jsxs)("li",{className:"flex items-start",children:[(0,l.jsx)("span",{className:"text-green-500 mr-2",children:"\u2713"}),(0,l.jsx)("span",{className:"text-gray-600",children:e})]},s))}),(0,l.jsx)("button",{onClick:t,className:"w-full py-3 bg-orange-500 text-white rounded-full font-medium hover:bg-orange-600 transition-colors",children:"Register Restaurant"})]})}),(0,l.jsx)("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden flex-1 border-t-4 border-teal-500",children:(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-4",children:"For Customers"}),(0,l.jsx)("ul",{className:"mb-8 space-y-3",children:["Browse menus from multiple restaurants","Simple ordering process","Real-time order tracking","Save favorite meals"].map((e,s)=>(0,l.jsxs)("li",{className:"flex items-start",children:[(0,l.jsx)("span",{className:"text-green-500 mr-2",children:"\u2713"}),(0,l.jsx)("span",{className:"text-gray-600",children:e})]},s))}),(0,l.jsx)("button",{onClick:t,className:"w-full py-3 bg-teal-600 text-white rounded-full font-medium hover:bg-teal-700 transition-colors",children:"Order Now"})]})})]})]})}),(0,l.jsx)("footer",{id:"contact",className:"bg-gray-800 text-white pt-16 pb-8",children:(0,l.jsxs)("div",{className:"container mx-auto px-4",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row justify-between mb-12",children:[(0,l.jsxs)("div",{className:"mb-8 md:mb-0",children:[(0,l.jsx)("h3",{className:"text-2xl font-bold text-orange-400 mb-4",children:"Mealy"}),(0,l.jsx)("p",{className:"text-gray-300 max-w-xs",children:"Connecting great food with hungry customers"})]}),(0,l.jsxs)("div",{className:"mb-8 md:mb-0",children:[(0,l.jsx)("h4",{className:"text-lg font-semibold mb-4",children:"Contact Us"}),(0,l.jsx)("p",{className:"text-gray-300 mb-2",children:"Email: info@mealy.com"}),(0,l.jsx)("p",{className:"text-gray-300",children:"Phone: 0712345678"})]})]}),(0,l.jsx)("div",{className:"pt-8 border-t border-gray-700 text-center text-gray-400",children:(0,l.jsx)("p",{children:"\xa9 2023 Mealy. All rights reserved."})})]})})]})},p=()=>{const{user:e}=(0,r.useAuth)();return e?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)(n,{}),"admin"===e.role?(0,l.jsx)(h,{}):(0,l.jsx)(x,{})]}):(0,l.jsx)(g,{})}},973:(e,s,t)=>{t.d(s,{A:()=>l});var a=t(43),r=t(213);const l=(e,s)=>{const[t,l]=(0,a.useState)(s),[n,d]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!e||"completed"===t)return;const s=setInterval(async()=>{try{const t=(await r.A.get(`/api/orders/${e}/`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}})).data.payment_status;l(t),"completed"!==t&&"failed"!==t||clearInterval(s)}catch(t){d("Error checking payment status"),clearInterval(s)}},5e3);return()=>clearInterval(s)},[e,t]),{status:t,error:n}}}}]);
//# sourceMappingURL=617.d233d3ce.chunk.js.map